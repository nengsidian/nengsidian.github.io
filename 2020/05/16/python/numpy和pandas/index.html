<!DOCTYPE HTML>
<html lang="zh-CN">

<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="李恒的博客">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->

<meta name="keywords" content="python,numpy,pandas" />


<meta name="description" content="numpy创建数组12345678a = np.array([1,2,3,4,5])np.arange(12).reshape(3, 4)# 查看数组的类型type(a)# 查看数据的类型a.d..." />


<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->

<title>
    
    numpy和pandas |
    
    李恒的博客
</title>

<link rel="alternate" href="/atom.xml" title="李恒的博客" type="application/atom+xml">


<link rel="icon" href="./favicon.ico">

    


<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7.css">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash.css">

    
<div class="hide">
    <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</div>




    

<meta name="generator" content="Hexo 4.2.1"></head>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header"  style="background-image:url(
    http://snippet.shenliyang.com/img/banner.jpg)"
     >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='liheng'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            <!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
            <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://yoursite.com">
                        李恒的博客</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa "></i>
                                首页</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/python/"><i class="fa "></i>
                                python</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/java/"><i class="fa "></i>
                                java</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/前端/"><i class="fa "></i>
                                前端</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/其他/"><i class="fa "></i>
                                其他</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa "></i>
                                时间轴</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="numpy和pandas">
            
            numpy和pandas
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a class="category-link" href="/categories/python/">python</a> <a class="category-link" href="/categories/python/numpy/">numpy</a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            <a class="tag-link" href="/tags/numpy/" rel="tag">numpy</a> <a class="tag-link" href="/tags/pandas/" rel="tag">pandas</a> <a class="tag-link" href="/tags/python/" rel="tag">python</a>
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2020/05/16</span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <h1 id="numpy"><a href="#numpy" class="headerlink" title="numpy"></a>numpy</h1><h4 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数组的类型</span></span><br><span class="line">type(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据的类型</span></span><br><span class="line">a.dtype</span><br></pre></td></tr></table></figure>

<h4 id="指定创建数组的数据类型"><a href="#指定创建数组的数据类型" class="headerlink" title="指定创建数组的数据类型"></a>指定创建数组的数据类型</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>], dtype=np.bool)  <span class="comment"># 或者使用dtype='?'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改数组的数据类型</span></span><br><span class="line">a.astype(<span class="string">"i1"</span>) <span class="comment"># 或者使用a.astype(np.int8)</span></span><br></pre></td></tr></table></figure>

<h4 id="修改浮点型的小数位数"><a href="#修改浮点型的小数位数" class="headerlink" title="修改浮点型的小数位数"></a>修改浮点型的小数位数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.round(b, <span class="number">2</span>)  <span class="comment"># b是浮点型数组</span></span><br></pre></td></tr></table></figure>

<h4 id="数组的形状"><a href="#数组的形状" class="headerlink" title="数组的形状"></a>数组的形状</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看数组的形状,得到的结果是一个元组</span></span><br><span class="line">a.shape</span><br><span class="line"><span class="comment"># 获取数组的行数</span></span><br><span class="line">a.shape[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 获取数组的列数</span></span><br><span class="line">a.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改数组的形状</span></span><br><span class="line">b = a.reshape(<span class="number">2</span>, <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把数组转化为一维数组</span></span><br><span class="line">a.flatten()</span><br></pre></td></tr></table></figure>

<h4 id="数组和数组的计算"><a href="#数组和数组的计算" class="headerlink" title="数组和数组的计算"></a>数组和数组的计算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 广播机制</span></span><br><span class="line">a + <span class="number">1</span></span><br><span class="line">a * <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>如果两个数组的后缘维度（即从末尾开始算起的维度）的轴长度相符或其中一方的长度为1，则认为它们是广播兼容的。广播会在缺失和（或）长度为1的维度上进行。</p>
<p>可以把维度指的是shape所对应的数字。</p>
<p>也就是说两个数组shape得到的元组的后2位要相同，或者后2位中一个相同，另外一个数字有一个数组为1</p>
<h4 id="numpy读取数据"><a href="#numpy读取数据" class="headerlink" title="numpy读取数据"></a>numpy读取数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.loadtxt(fname,dtype=np.float,delimiter=<span class="literal">None</span>,skiprows=<span class="number">0</span>,usecols=<span class="literal">None</span>,unpack=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 例如：</span></span><br><span class="line">np.loadtxt(US_video_data_numbers_path, delimiter=<span class="string">","</span>, dtype=int,unpack=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>frame</td>
<td>文件、字符串或产生器，可以是.gz或bz2压缩文件</td>
</tr>
<tr>
<td>dtype</td>
<td>数据类型，可选，csv的字符串以什么数据类型读入数组中，默认np.float</td>
</tr>
<tr>
<td>delimiter</td>
<td>分割字符串，默认是任何空格，改为逗号</td>
</tr>
<tr>
<td>skiprows</td>
<td>跳过前X行，一般跳过第一行表头</td>
</tr>
<tr>
<td>usecols</td>
<td>读取指定的列，索引，元组类型</td>
</tr>
<tr>
<td>unpack</td>
<td>如果True，读入属性将分别写入不同数组变量，False读入数据只写入一个数组变量，默认False。相当于转置的效果</td>
</tr>
</tbody></table>
<h4 id="numpy中的转置"><a href="#numpy中的转置" class="headerlink" title="numpy中的转置"></a>numpy中的转置</h4><p>转置是一种变换，对于numpy中的数组来说，就是在对角线方向交换数据，目的也是为了更方便的去处理数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转置的3种方法</span></span><br><span class="line">t.transpose()</span><br><span class="line">t.swapaxes(<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">t.T</span><br></pre></td></tr></table></figure>

<h4 id="numpy的索引和切片"><a href="#numpy的索引和切片" class="headerlink" title="numpy的索引和切片"></a>numpy的索引和切片</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">1</span>]  <span class="comment"># 取第2行</span></span><br><span class="line">a[<span class="number">1</span>:<span class="number">3</span>]  <span class="comment"># 取第2到第3行</span></span><br><span class="line">a[:, <span class="number">2</span>]  <span class="comment"># 取第3列</span></span><br><span class="line">a[:, <span class="number">2</span>:<span class="number">4</span>]  <span class="comment"># 取第3到第4列</span></span><br><span class="line">a[[<span class="number">1</span>,<span class="number">3</span>], :]  <span class="comment"># 分别取第2行和第3行</span></span><br><span class="line">a[:[<span class="number">2</span>,<span class="number">4</span>]]  <span class="comment"># 分别取第3列和第4列</span></span><br><span class="line">a[[<span class="number">1</span>:<span class="number">3</span>],[<span class="number">2</span>,<span class="number">4</span>]]  <span class="comment"># 取第2行第3行和第3列第4列的交集</span></span><br><span class="line">a[:,<span class="number">2</span>:<span class="number">8</span>:<span class="number">2</span>]  <span class="comment"># 取第3列到第8列，步长为2</span></span><br><span class="line">a[:,<span class="number">2</span>:<span class="number">4</span>] = <span class="number">0</span>  <span class="comment"># 把第3列到第4列的值设置为0</span></span><br></pre></td></tr></table></figure>

<h4 id="numpy中布尔索引"><a href="#numpy中布尔索引" class="headerlink" title="numpy中布尔索引"></a>numpy中布尔索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">t = np.arange(<span class="number">24</span>).reshape(<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line">print(t &lt; <span class="number">10</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">array([[ <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>],</span><br><span class="line">       [ <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>],</span><br><span class="line">       [<span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>],</span><br><span class="line">       [<span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>]])</span><br><span class="line"><span class="comment"># 以上是t&lt;10的输出结果</span></span><br><span class="line"></span><br><span class="line">t[t&lt;<span class="number">10</span>]=<span class="number">0</span></span><br><span class="line">print(t)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[ <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>]</span><br><span class="line"> [ <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> <span class="number">10</span> <span class="number">11</span>]</span><br><span class="line"> [<span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span>]</span><br><span class="line"> [<span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span>]]</span><br></pre></td></tr></table></figure>

<h4 id="numpy中的三元运算符"><a href="#numpy中的三元运算符" class="headerlink" title="numpy中的三元运算符"></a>numpy中的三元运算符</h4><p>把t中小于10的数字替换为0，把大于10的替换为10</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">t = np.where(t&lt;<span class="number">10</span>,<span class="number">0</span>,<span class="number">10</span>)</span><br><span class="line">print(t)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[ <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>]</span><br><span class="line"> [ <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> <span class="number">10</span> <span class="number">10</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span>]]</span><br></pre></td></tr></table></figure>

<h4 id="numpy中的clip（裁剪）"><a href="#numpy中的clip（裁剪）" class="headerlink" title="numpy中的clip（裁剪）"></a>numpy中的clip（裁剪）</h4><p>把t中小于10的数字替换为10，大于20的数字替换为20，其他数字不变</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">t = t.clip(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">print(t)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span> <span class="number">11</span>]</span><br><span class="line"> [<span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span>]</span><br><span class="line"> [<span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">20</span> <span class="number">20</span> <span class="number">20</span>]]</span><br></pre></td></tr></table></figure>

<h4 id="numpy中的nan和inf"><a href="#numpy中的nan和inf" class="headerlink" title="numpy中的nan和inf"></a>numpy中的nan和inf</h4><p>nan(NAN,Nan):not a number表示不是一个数字</p>
<h5 id="什么时候会出现numpy中的nan："><a href="#什么时候会出现numpy中的nan：" class="headerlink" title="什么时候会出现numpy中的nan："></a>什么时候会出现numpy中的nan：</h5><ul>
<li>当我们读取本地的文件为float的时候，如果有缺失，就会出现nan</li>
<li>当做了一个不合适的计算的时候（比如无穷大（inf）减去无穷大）</li>
</ul>
<p>inf(-inf,inf):infinity，inf表示正无穷，-inf表示负无穷</p>
<p>#####什么时候会出现inf(-inf,inf):</p>
<ul>
<li>比如一个数字除以0，（python中直接回报错，numpy中是一个inf或者-inf）</li>
</ul>
<p>#####inf和nan的type类型都是float</p>
<p>#####nan中的注意点：</p>
<ul>
<li>两个nan是不相等的，即np.nan != np.nan</li>
<li>可以利用以上的特性，判断数组中nan的个数<ul>
<li>np.count_nonzero(t != t)</li>
</ul>
</li>
<li>如果判断一个数字是否为nan呢？通过np.isnan(a)来判断，返回bool类型，比较把nan替换为0<ul>
<li>t[np.isnan(t)] = 0</li>
</ul>
</li>
<li>nan和任何值计算都为nan</li>
</ul>
<h4 id="numpy中常用统计函数"><a href="#numpy中常用统计函数" class="headerlink" title="numpy中常用统计函数"></a>numpy中常用统计函数</h4><ul>
<li>求和：t.sum(axis=None)</li>
<li>均值：t.mean(a,axis=None) 受离群点的影响较大</li>
<li>中值：np.median(t,axis=None)</li>
<li>最大值：t.max(axis=None)</li>
<li>最小值：t.min(axis=None)</li>
<li>极值：np.ptp(t,axis=None) 即最大值和最小值只差</li>
<li>标准差： t.std(axis=None)</li>
</ul>
<p>默认返回多维数组的全部的统计结果，如果指定axis则返回一个当前轴上的结果</p>
<p>标准差：是一组数据平均值分散程度的一种度量。一个较大的标准差，代表大部分数值和其平均值之间差异较大；一个较小的标准差，代表这些数值较接近平均值反映出数据的波动稳定情况，越大表示波动越大，越不稳定。</p>
<h4 id="ndarry缺失值填充均值"><a href="#ndarry缺失值填充均值" class="headerlink" title="ndarry缺失值填充均值"></a>ndarry缺失值填充均值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">t = np.array([[  <span class="number">0.</span>,   <span class="number">1.</span>,   <span class="number">2.</span>,   <span class="number">3.</span>,   <span class="number">4.</span>,   <span class="number">5.</span>],</span><br><span class="line">       [  <span class="number">6.</span>,   <span class="number">7.</span>,  np.nan,   <span class="number">9.</span>,  <span class="number">10.</span>,  <span class="number">11.</span>],</span><br><span class="line">       [ <span class="number">12.</span>,  <span class="number">13.</span>,  <span class="number">14.</span>,  np.nan,  <span class="number">16.</span>,  <span class="number">17.</span>],</span><br><span class="line">       [ <span class="number">18.</span>,  <span class="number">19.</span>,  <span class="number">20.</span>,  <span class="number">21.</span>,  <span class="number">22.</span>,  <span class="number">23.</span>]])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill_nan_by_column_mean</span><span class="params">(t)</span>:</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(t.shape[<span class="number">1</span>]):</span><br><span class="line">    nan_num = np.count_nonzero(t[:, i][t[:, i] != t[:, i]])  <span class="comment"># 计算非nan的个数</span></span><br><span class="line">    <span class="keyword">if</span> nan_num &gt; <span class="number">0</span>:  <span class="comment"># 存在的nan值</span></span><br><span class="line">      now_col = t[:, i]</span><br><span class="line">      now_col_not_nan = now_col[np.isnan(now_col) == <span class="literal">False</span>].sum()  <span class="comment"># 求和</span></span><br><span class="line">      now_col_mean = now_col_not_nan / (t.shape[<span class="number">0</span>] - nan_num)  <span class="comment"># 和/个数</span></span><br><span class="line">      now_col[np.isnan(now_col)] = now_col_mean  <span class="comment"># 赋值给now_col</span></span><br><span class="line">      t[:, i] = now_col  <span class="comment"># 赋值给t，即更新t的当前列</span></span><br><span class="line">    </span><br><span class="line">fill_nan_by_column_mean(t)</span><br><span class="line">print(t)</span><br></pre></td></tr></table></figure>

<h4 id="数组的拼接"><a href="#数组的拼接" class="headerlink" title="数组的拼接"></a>数组的拼接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.vstack((t1,t2))  <span class="comment"># 竖直拼接</span></span><br><span class="line">np.hstack((t1,t2))  <span class="comment"># 水平拼接</span></span><br></pre></td></tr></table></figure>

<h4 id="数组的行列交换"><a href="#数组的行列交换" class="headerlink" title="数组的行列交换"></a>数组的行列交换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t[[<span class="number">1</span>,<span class="number">2</span>],:] = t[[<span class="number">2</span>,<span class="number">1</span>],:]  <span class="comment"># 行交换</span></span><br><span class="line">t[:,[<span class="number">0</span>,<span class="number">2</span>]] = t[:,[<span class="number">2</span>,<span class="number">0</span>]]  <span class="comment"># 列交换</span></span><br></pre></td></tr></table></figure>

<h4 id="numpy更多好用的方法"><a href="#numpy更多好用的方法" class="headerlink" title="numpy更多好用的方法"></a>numpy更多好用的方法</h4><ol>
<li>获取最大值最小值的位置<ol>
<li>np.argmax(t,axis=0)</li>
<li>np.argmin(t,axis=1)</li>
</ol>
</li>
<li>创建一个全0的数组：np.zeros((3,4))</li>
<li>创建一个全1的数组：np.ones((3,4))</li>
<li>创建一个对角线为1的正方形数组（方阵）：np,eye(3)</li>
</ol>
<h4 id="生成随机数"><a href="#生成随机数" class="headerlink" title="生成随机数"></a>生成随机数</h4><p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/numpy%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%95%B0.png" alt></p>
<h4 id="numpy的注意点copy和view"><a href="#numpy的注意点copy和view" class="headerlink" title="numpy的注意点copy和view"></a>numpy的注意点copy和view</h4><ol>
<li>a=b完全不复制，a和b相互影响</li>
<li>a=b[:]，视图的操作，一种切片，会创建新的对象a，但是a的数据完全由b保管，他们两个的数据变化是一致的。</li>
<li>a=b.copy()，复制，a和b互不影响。</li>
</ol>
<h1 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h1><p>numpy能够帮助我们处理数值，但是pandas除了处理数值之外（基于numpy），还能够帮助我们处理其他类型的数据</p>
<h4 id="pandas之Series创建"><a href="#pandas之Series创建" class="headerlink" title="pandas之Series创建"></a>pandas之Series创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法一</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">t = pd.Series(np.arange(<span class="number">10</span>), index=list(string.ascii_uppercase[:<span class="number">10</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line">a = &#123;string.ascii_uppercase[i]:i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)&#125;</span><br><span class="line">pd.Series(a)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">A    <span class="number">0</span></span><br><span class="line">B    <span class="number">1</span></span><br><span class="line">C    <span class="number">2</span></span><br><span class="line">D    <span class="number">3</span></span><br><span class="line">E    <span class="number">4</span></span><br><span class="line">F    <span class="number">5</span></span><br><span class="line">G    <span class="number">6</span></span><br><span class="line">H    <span class="number">7</span></span><br><span class="line">I    <span class="number">8</span></span><br><span class="line">J    <span class="number">9</span></span><br><span class="line">dtype: int64</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 重新指定索引</span></span><br><span class="line">pd.Series(a, index=list(string.ascii_uppercase[<span class="number">5</span>:<span class="number">15</span>]))</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">F    <span class="number">5.0</span></span><br><span class="line">G    <span class="number">6.0</span></span><br><span class="line">H    <span class="number">7.0</span></span><br><span class="line">I    <span class="number">8.0</span></span><br><span class="line">J    <span class="number">9.0</span></span><br><span class="line">K    NaN</span><br><span class="line">L    NaN</span><br><span class="line">M    NaN</span><br><span class="line">N    NaN</span><br><span class="line">O    NaN</span><br><span class="line">dtype: float64</span><br><span class="line"><span class="comment"># 重新给其指定其他的索引之后，如果能够对应上，就取其值，如果不能，就为Nan</span></span><br><span class="line"><span class="comment"># 为什么类型为float呢？</span></span><br><span class="line">numpy中nan为float，pandas会自动根据数据类更改series的dtype类型</span><br><span class="line">pandas修改dtype和numpy的方法一样</span><br></pre></td></tr></table></figure>

<h4 id="pandas之Series切片和索引"><a href="#pandas之Series切片和索引" class="headerlink" title="pandas之Series切片和索引"></a>pandas之Series切片和索引</h4><p>切片：直接传入start end或者步长即可</p>
<p>索引：一个的时候直接传入序号或者index，多个的时候传入序号或者index的列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">t = pd.Series(np.arange(<span class="number">10</span>), index=list(<span class="string">"ABCDEFGHIJ"</span>))</span><br><span class="line">  </span><br><span class="line">t[<span class="number">2</span>:<span class="number">10</span>:<span class="number">2</span>]  <span class="comment"># 切片 步长为2</span></span><br><span class="line">t[<span class="number">1</span>]  <span class="comment"># 取索引</span></span><br><span class="line">t[[<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>]]  <span class="comment"># 取索引，索引分别为2，3，6</span></span><br><span class="line">t[t&gt;<span class="number">4</span>]  <span class="comment"># 值大于4的所有数据</span></span><br><span class="line">t[<span class="string">"F"</span>]  <span class="comment"># 索引为F的数据</span></span><br><span class="line">t[[<span class="string">"A"</span>, <span class="string">"F"</span>, <span class="string">"g"</span>]]  <span class="comment"># 索引为A，F，g的数据，因为索引g没有，所以取出的值为NaN</span></span><br></pre></td></tr></table></figure>

<h4 id="pandas之Series的索引和值"><a href="#pandas之Series的索引和值" class="headerlink" title="pandas之Series的索引和值"></a>pandas之Series的索引和值</h4><p>Series对象本质上由两个数组构成，一个数组构成对象的键（index, 索引），一个数组构成对象的值（values），键-&gt;值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">t.index</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">Index([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>], dtype=<span class="string">'object'</span>)</span><br><span class="line"></span><br><span class="line">t.values</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">type(t.index)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">pandas.core.indexes.base.Index</span><br><span class="line"></span><br><span class="line">type(t.values)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">numpy.ndarray</span><br></pre></td></tr></table></figure>

<p>ndarray的很多方法都可以运用于series类型，比如argmax，clip</p>
<p>series具有where方法，但是结果和ndarray不同</p>
<h4 id="Series的tolist-方法和unique-方法"><a href="#Series的tolist-方法和unique-方法" class="headerlink" title="Series的tolist()方法和unique()方法"></a>Series的tolist()方法和unique()方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>])</span><br><span class="line">df.tolist()</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">df = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>])</span><br><span class="line">df.unique()</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<h4 id="pandas之读取外部数据"><a href="#pandas之读取外部数据" class="headerlink" title="pandas之读取外部数据"></a>pandas之读取外部数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv</span><br><span class="line">pd.read_sql(sql_sentence, connection)</span><br></pre></td></tr></table></figure>

<h4 id="pandas之DataFrame的创建"><a href="#pandas之DataFrame的创建" class="headerlink" title="pandas之DataFrame的创建"></a>pandas之DataFrame的创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法一</span></span><br><span class="line">t = pd.DataFrame(np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>,<span class="number">4</span>),index=list(<span class="string">"ABC"</span>),columns=list(<span class="string">"WXYZ"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line">t_dict = &#123;</span><br><span class="line">  <span class="string">"name"</span>:[<span class="string">"zhangsan"</span>, <span class="string">"lisi"</span>], </span><br><span class="line">  <span class="string">"age"</span>:[<span class="string">"12"</span>, <span class="string">"20"</span>], </span><br><span class="line">&#125;</span><br><span class="line">pd.DataFrame(t_dict)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法三</span></span><br><span class="line">t_dict = [</span><br><span class="line">  &#123;<span class="string">"name"</span>: <span class="string">"zhangsan"</span>, <span class="string">"age"</span>: <span class="number">12</span>&#125;,</span><br><span class="line">  &#123;<span class="string">"name"</span>: <span class="string">"lisi"</span>, <span class="string">"age"</span>: <span class="number">20</span>&#125;,</span><br><span class="line">]</span><br><span class="line">pd.DataFrame(t_dict)</span><br></pre></td></tr></table></figure>

<h4 id="DataFrame的基础属性和整体情况查询"><a href="#DataFrame的基础属性和整体情况查询" class="headerlink" title="DataFrame的基础属性和整体情况查询"></a>DataFrame的基础属性和整体情况查询</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基础属性</span></span><br><span class="line">df.shape  <span class="comment"># 行数 列数</span></span><br><span class="line">df.dtypes  <span class="comment"># 列数据类型</span></span><br><span class="line">df.ndim  <span class="comment"># 数据维度</span></span><br><span class="line">df.index  <span class="comment"># 行索引</span></span><br><span class="line">df.colums  <span class="comment"># 列索引</span></span><br><span class="line">df.values  <span class="comment"># 对象值，二维ndarray数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整体情况查询</span></span><br><span class="line">df.head(<span class="number">3</span>)  <span class="comment"># 显示头部几行，默认5行</span></span><br><span class="line">de.tail(<span class="number">3</span>)  <span class="comment"># 显示尾部几行，默认5行</span></span><br><span class="line">df.info()  <span class="comment"># 相关信息概览：行数，列数，列索引，列非空值个数，列类型，内存占用</span></span><br><span class="line">df.describe()  <span class="comment"># 快速综合统计结果：计数，均值，标准差，最大值，四分位数，最小值</span></span><br></pre></td></tr></table></figure>

<h4 id="对某一列进行排序"><a href="#对某一列进行排序" class="headerlink" title="对某一列进行排序"></a>对某一列进行排序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对Count_AnimalName列进行排序，ascending=False表示从大到小排序</span></span><br><span class="line">df.sort_values(by=<span class="string">"Count_AnimalName"</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h4 id="DataFrame之取行或者列"><a href="#DataFrame之取行或者列" class="headerlink" title="DataFrame之取行或者列"></a>DataFrame之取行或者列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.arange(<span class="number">56</span>).reshape(<span class="number">7</span>,<span class="number">8</span>), index=list(<span class="string">"ABCDEFG"</span>), columns=list(<span class="string">"STUVWXYZ"</span>))</span><br><span class="line"><span class="comment"># 取第X列</span></span><br><span class="line">df[<span class="string">"X"</span>]</span><br><span class="line"><span class="comment"># 取第X、Z列</span></span><br><span class="line">df[[<span class="string">"X"</span>, <span class="string">"Z"</span>]]</span><br><span class="line"><span class="comment"># 取第3到第6行</span></span><br><span class="line">df[<span class="number">2</span>:<span class="number">6</span>]</span><br><span class="line"><span class="comment"># 取第3到第6行和第X列</span></span><br><span class="line">df[<span class="number">2</span>:<span class="number">6</span>][<span class="string">"X"</span>]</span><br></pre></td></tr></table></figure>

<h4 id="DataFrame之loc和iloc"><a href="#DataFrame之loc和iloc" class="headerlink" title="DataFrame之loc和iloc"></a>DataFrame之loc和iloc</h4><ul>
<li>df.loc 通过标签索引行数据</li>
<li>Df.iloc 通过位置获取行数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取A行，W列交集的数据</span></span><br><span class="line">df.loc[<span class="string">"A"</span>, <span class="string">"W"</span>]</span><br><span class="line"><span class="comment"># 取A行和W、Z交集的数据</span></span><br><span class="line">df.loc[<span class="string">"A"</span>, [<span class="string">"W"</span>, <span class="string">"Z"</span>]]</span><br><span class="line"><span class="comment"># 取A、C行和W、Z交集的数据</span></span><br><span class="line">df.loc[[<span class="string">"A"</span>, <span class="string">"c"</span>], [<span class="string">"W"</span>, <span class="string">"Z"</span>]]</span><br><span class="line"><span class="comment"># 取A行及A行之后所有行和W、Z的交集</span></span><br><span class="line">df.loc[<span class="string">"A"</span>: [<span class="string">"W"</span>, <span class="string">"Z"</span>]]</span><br><span class="line"><span class="comment"># 取A行到C行和W、Z的交集</span></span><br><span class="line">df.loc[<span class="string">"A"</span>:<span class="string">"C"</span>,[<span class="string">"W"</span>,<span class="string">"Z"</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取第2行到第3行和第3列、第4列的交集</span></span><br><span class="line">df.iloc[<span class="number">1</span>:<span class="number">3</span>, [<span class="number">2</span>,<span class="number">3</span>]]</span><br><span class="line"><span class="comment"># 取第2行到第3行和第2列到第3列的交集</span></span><br><span class="line">df.iloc[<span class="number">1</span>:<span class="number">3</span>,<span class="number">1</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p>赋值更改数据的过程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">"A"</span>, <span class="string">"Y"</span>] = <span class="number">100</span></span><br><span class="line">df.iloc[<span class="number">1</span>:<span class="number">2</span>,<span class="number">0</span>:<span class="number">2</span>] = <span class="number">200</span></span><br></pre></td></tr></table></figure>

<h4 id="DataFrame之布尔索引"><a href="#DataFrame之布尔索引" class="headerlink" title="DataFrame之布尔索引"></a>DataFrame之布尔索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找到使用次数超过800的狗的名字</span></span><br><span class="line">df[df[<span class="string">"Count_AnimalName"</span>]&gt;<span class="number">800</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到所有使用次数超过700并且名字的字符串的长度大于4的狗的名字</span></span><br><span class="line">df[(df[<span class="string">"Row_Labels"</span>].str.len()&gt;<span class="number">4</span>)&amp;(df[<span class="string">"Count_AnimalName"</span>]&gt;<span class="number">700</span>)]</span><br><span class="line"><span class="comment"># &amp;符号表示：且</span></span><br><span class="line"><span class="comment"># |符号表示：或</span></span><br></pre></td></tr></table></figure>

<h4 id="pandas之字符串方法"><a href="#pandas之字符串方法" class="headerlink" title="pandas之字符串方法"></a>pandas之字符串方法</h4><p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/pandas%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E6%B3%95.png" alt></p>
<h4 id="缺失数据的处理"><a href="#缺失数据的处理" class="headerlink" title="缺失数据的处理"></a>缺失数据的处理</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 判断数据是否为NaN</span></span><br><span class="line">pd.isnull(df)  <span class="comment"># 是NaN</span></span><br><span class="line">pd.notnull(df)  <span class="comment"># 不是NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理方式1：删除NaN所在的行列</span></span><br><span class="line">t.dropna(axis=<span class="number">0</span>,how=<span class="string">'any'</span>,inplace=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 填充数据</span></span><br><span class="line">t.fillna(t.mean())</span><br><span class="line">t.fillna(t.median())</span><br><span class="line">t.fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>处理为0的数据：t[t==0]=np.nan</p>
<p>当然并不是每次为0的数据都需要处理</p>
<p>计算平均值等情况，nan是不参与计算的，但是0会</p>
<h4 id="pandas常用统计方法"><a href="#pandas常用统计方法" class="headerlink" title="pandas常用统计方法"></a>pandas常用统计方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 评分的平均分</span></span><br><span class="line">rating_mean = df[<span class="string">"Rating"</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导演的人数</span></span><br><span class="line">temp_list = df[<span class="string">"Actors"</span>].str.split(<span class="string">","</span>).tolist()</span><br><span class="line">nums = set([i <span class="keyword">for</span> j <span class="keyword">in</span> temp_list <span class="keyword">for</span> i <span class="keyword">in</span> j])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 电影市场的最大最小值</span></span><br><span class="line">max_runtime = df[<span class="string">"Runtime(Minutes)"</span>].max()</span><br><span class="line">max_runtime_index = df[<span class="string">"Runtime(Minutes)"</span>].argmax()</span><br><span class="line">min_runtime = df[<span class="string">"Runtime(Minutes)"</span>].min()</span><br><span class="line">min_runtime_index = df[<span class="string">"Runtime(Minutes)"</span>].argmin()</span><br><span class="line">runtime_median = df[<span class="string">"Runtime(Minutes)"</span>].median()</span><br></pre></td></tr></table></figure>

<h4 id="数据合并之join、merge"><a href="#数据合并之join、merge" class="headerlink" title="数据合并之join、merge"></a>数据合并之join、merge</h4><p>join：默认情况下他是把行索引相同的数据合并到一起</p>
<p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/join.png" alt></p>
<p>merge:按照指定的列把数据按照一定的方式合并到一起</p>
<p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/merge.png" alt></p>
<p>默认的合并方式inner：并集</p>
<p>outer：交集，NaN补全</p>
<p>left：左边为准，NaN补全</p>
<p>right：右边为准，NaN补全</p>
<h4 id="分组和聚合"><a href="#分组和聚合" class="headerlink" title="分组和聚合"></a>分组和聚合</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grouped = df.groupby(by=<span class="string">"columns_name"</span>)</span><br></pre></td></tr></table></figure>

<p>grouped是一个DataFrameGroupBy对象，是可迭代的。<br>grouped中的每一个元素是一个元组<br>元组里面是（索引(分组的值)，分组之后的DataFrame）</p>
<p>如果我们需要对国家和省份进行分组统计，应该怎么操作呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grouped = df.groupby(by=[df[<span class="string">"Country"</span>],df[<span class="string">"State/Province"</span>]])</span><br></pre></td></tr></table></figure>

<p>很多时候我们只希望对获取分组之后的某一部分数据，或者说我们只希望对某几列数据进行分组，这个时候我们应该怎么办呢？</p>
<p>获取分组之后的某一部分数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(by=[<span class="string">"Country"</span>,<span class="string">"State/Province"</span>])[<span class="string">"Country"</span>].count()</span><br></pre></td></tr></table></figure>

<p>对某几列数据进行分组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"Country"</span>].groupby(by=[df[<span class="string">"Country"</span>],df[<span class="string">"State/Province"</span>]]).count()</span><br></pre></td></tr></table></figure>

<p>观察结果，由于只选择了一列数据，所以结果是一个Series类型，如果我想返回一个DataFrame类型呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t1 = df[[<span class="string">"Country"</span>]].groupby(by=[df[<span class="string">"Country"</span>],df[<span class="string">"State/Province"</span>]]).count()</span><br><span class="line">t2 = df.groupby(by=[<span class="string">"Country"</span>,<span class="string">"State/Province"</span>])[[<span class="string">"Country"</span>]].count()</span><br></pre></td></tr></table></figure>

<p>以上的两条命令结果一样<br>和之前的结果的区别在于当前返回的是一个DataFrame类型</p>
<h4 id="索引和复合索引"><a href="#索引和复合索引" class="headerlink" title="索引和复合索引"></a>索引和复合索引</h4><p>简单的索引操作：</p>
<ul>
<li>获取index：df.index</li>
<li>指定index ：df.index = [‘x’,’y’]</li>
<li>重新设置index : df.reindex(list(“abcedf”))</li>
<li>指定某一列作为index ：df.set_index(“Country”,drop=False)</li>
<li>返回index的唯一值：df.set_index(“Country”).index.unique()</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">a = pd.DataFrame(&#123;<span class="string">'a'</span>: range(<span class="number">7</span>),<span class="string">'b'</span>: range(<span class="number">7</span>, <span class="number">0</span>, <span class="number">-1</span>),<span class="string">'c'</span>: [<span class="string">'one'</span>,<span class="string">'one'</span>,<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>, <span class="string">'two'</span>],<span class="string">'d'</span>: list(<span class="string">"hjklmno"</span>)&#125;)</span><br><span class="line">a</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">	a	b	c	d</span><br><span class="line"><span class="number">0</span>	<span class="number">0</span>	<span class="number">7</span>	one	h</span><br><span class="line"><span class="number">1</span>	<span class="number">1</span>	<span class="number">6</span>	one	j</span><br><span class="line"><span class="number">2</span>	<span class="number">2</span>	<span class="number">5</span>	one	k</span><br><span class="line"><span class="number">3</span>	<span class="number">3</span>	<span class="number">4</span>	two	l</span><br><span class="line"><span class="number">4</span>	<span class="number">4</span>	<span class="number">3</span>	two	m</span><br><span class="line"><span class="number">5</span>	<span class="number">5</span>	<span class="number">2</span>	two	n</span><br><span class="line"><span class="number">6</span>	<span class="number">6</span>	<span class="number">1</span>	two	o</span><br><span class="line"></span><br><span class="line">x = a.set_index([<span class="string">"c"</span>,<span class="string">"d"</span>])[<span class="string">"a"</span>]</span><br><span class="line">x</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">c    d</span><br><span class="line">one  h    <span class="number">0</span></span><br><span class="line">     j    <span class="number">1</span></span><br><span class="line">     k    <span class="number">2</span></span><br><span class="line">two  l    <span class="number">3</span></span><br><span class="line">     m    <span class="number">4</span></span><br><span class="line">     n    <span class="number">5</span></span><br><span class="line">     o    <span class="number">6</span></span><br><span class="line">Name: a, dtype: int64</span><br><span class="line">    </span><br><span class="line">x[<span class="string">"one"</span>, <span class="string">"h"</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>x.swaplevel() 复合索引中交换索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = x.swaplevel() </span><br><span class="line">x</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">d  c  </span><br><span class="line">h  one    <span class="number">0</span></span><br><span class="line">j  one    <span class="number">1</span></span><br><span class="line">k  one    <span class="number">2</span></span><br><span class="line">l  two    <span class="number">3</span></span><br><span class="line">m  two    <span class="number">4</span></span><br><span class="line">n  two    <span class="number">5</span></span><br><span class="line">o  two    <span class="number">6</span></span><br><span class="line">Name: a, dtype: int64</span><br></pre></td></tr></table></figure>

<h4 id="pandas中的时间序列"><a href="#pandas中的时间序列" class="headerlink" title="pandas中的时间序列"></a>pandas中的时间序列</h4><h5 id="时间序列的生成"><a href="#时间序列的生成" class="headerlink" title="时间序列的生成"></a>时间序列的生成</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.date_range(start=<span class="literal">None</span>, end=<span class="literal">None</span>, periods=<span class="literal">None</span>, freq=<span class="string">'D'</span>)</span><br></pre></td></tr></table></figure>

<p>start和end以及freq配合能够生成start和end范围内以频率freq的一组时间索引<br>start和periods以及freq配合能够生成从start开始的频率为freq的periods个时间索引</p>
<p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.png" alt></p>
<p>关于频率的更多缩写</p>
<p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/%E5%85%B3%E4%BA%8E%E9%A2%91%E7%8E%87%E7%9A%84%E6%9B%B4%E5%A4%9A%E7%BC%A9%E5%86%99.png" alt></p>
<h5 id="在DataFrame中使用时间序列"><a href="#在DataFrame中使用时间序列" class="headerlink" title="在DataFrame中使用时间序列"></a>在DataFrame中使用时间序列</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index=pd.date_range(<span class="string">"20170101"</span>,periods=<span class="number">10</span>)</span><br><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>),index=index)</span><br></pre></td></tr></table></figure>

<p>可以使用pandas提供的方法把时间字符串转化为时间序列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"timeStamp"</span>] = pd.to_datetime(df[<span class="string">"timeStamp"</span>],format=<span class="string">""</span>)format参数大部分情况下可以不用写，但是对于pandas无法格式化的时间字符串，我们可以使用该参数，比如包含中文</span><br></pre></td></tr></table></figure>

<h5 id="pandas重采样"><a href="#pandas重采样" class="headerlink" title="pandas重采样"></a>pandas重采样</h5><p>重采样：指的是将时间序列从一个频率转化为另一个频率进行处理的过程，将高频率数据转化为低频率数据为降采样，低频率转化为高频率为升采样。</p>
<p>pandas提供了一个resample的方法来帮助我们实现频率转化</p>
<p><img src="/2020/05/16/python/numpy%E5%92%8Cpandas/%E9%87%8D%E9%87%87%E6%A0%B7.png" alt></p>
<h5 id="Periodlndex"><a href="#Periodlndex" class="headerlink" title="Periodlndex"></a>Periodlndex</h5><p>之前所学习的DatetimeIndex可以理解为时间戳<br>那么现在我们要学习的PeriodIndex可以理解为时间段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">periods = pd.PeriodIndex(year=data[<span class="string">"year"</span>],month=data[<span class="string">"month"</span>],day=data[<span class="string">"day"</span>],hour=data[<span class="string">"hour"</span>],freq=<span class="string">"H"</span>)</span><br></pre></td></tr></table></figure>


    </div>
    
    <div class="post-footer">
        <div>
            
            转载声明：
            商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">Snippet</a>
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    <a href="/2020/05/16/others/pycharm%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%A4%A7%E5%85%A8/" class="pre-post btn btn-default" title='pycharm快捷键大全'>
        <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
        <span class="hidden-xs">
            pycharm快捷键大全</span>
    </a>
    
    
</div>

<div id="comments">
    

<div id="vcomments" class="valine"></div>

<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

<script>
new Valine({
    av: AV,
    el: '#vcomments',
    appId: 'xOKV9J4UeQAtVkvnJC7Kq2Jn-gzGzoHsz',
    appKey: 'erIpQac4azoCmgfBB7Dl9maa',
    placeholder: '说点什么吧',
    notify: false,
    verify: true,
    avatar: 'mm',
    meta: 'nick,mail'.split(','),
    pageSize: '10',
    path: window.location.pathname,
    lang: 'zh-CN'.toLowerCase()
})
</script>


</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            文章目录
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#numpy"><span class="toc-text">numpy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建数组"><span class="toc-text">创建数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定创建数组的数据类型"><span class="toc-text">指定创建数组的数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改浮点型的小数位数"><span class="toc-text">修改浮点型的小数位数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数组的形状"><span class="toc-text">数组的形状</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数组和数组的计算"><span class="toc-text">数组和数组的计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy读取数据"><span class="toc-text">numpy读取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy中的转置"><span class="toc-text">numpy中的转置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy的索引和切片"><span class="toc-text">numpy的索引和切片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy中布尔索引"><span class="toc-text">numpy中布尔索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy中的三元运算符"><span class="toc-text">numpy中的三元运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy中的clip（裁剪）"><span class="toc-text">numpy中的clip（裁剪）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy中的nan和inf"><span class="toc-text">numpy中的nan和inf</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#什么时候会出现numpy中的nan："><span class="toc-text">什么时候会出现numpy中的nan：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy中常用统计函数"><span class="toc-text">numpy中常用统计函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ndarry缺失值填充均值"><span class="toc-text">ndarry缺失值填充均值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数组的拼接"><span class="toc-text">数组的拼接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数组的行列交换"><span class="toc-text">数组的行列交换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy更多好用的方法"><span class="toc-text">numpy更多好用的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#生成随机数"><span class="toc-text">生成随机数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy的注意点copy和view"><span class="toc-text">numpy的注意点copy和view</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pandas"><span class="toc-text">pandas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas之Series创建"><span class="toc-text">pandas之Series创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas之Series切片和索引"><span class="toc-text">pandas之Series切片和索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas之Series的索引和值"><span class="toc-text">pandas之Series的索引和值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Series的tolist-方法和unique-方法"><span class="toc-text">Series的tolist()方法和unique()方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas之读取外部数据"><span class="toc-text">pandas之读取外部数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas之DataFrame的创建"><span class="toc-text">pandas之DataFrame的创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DataFrame的基础属性和整体情况查询"><span class="toc-text">DataFrame的基础属性和整体情况查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#对某一列进行排序"><span class="toc-text">对某一列进行排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DataFrame之取行或者列"><span class="toc-text">DataFrame之取行或者列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DataFrame之loc和iloc"><span class="toc-text">DataFrame之loc和iloc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DataFrame之布尔索引"><span class="toc-text">DataFrame之布尔索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas之字符串方法"><span class="toc-text">pandas之字符串方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#缺失数据的处理"><span class="toc-text">缺失数据的处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas常用统计方法"><span class="toc-text">pandas常用统计方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据合并之join、merge"><span class="toc-text">数据合并之join、merge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分组和聚合"><span class="toc-text">分组和聚合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#索引和复合索引"><span class="toc-text">索引和复合索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas中的时间序列"><span class="toc-text">pandas中的时间序列</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#时间序列的生成"><span class="toc-text">时间序列的生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#在DataFrame中使用时间序列"><span class="toc-text">在DataFrame中使用时间序列</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#pandas重采样"><span class="toc-text">pandas重采样</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Periodlndex"><span class="toc-text">Periodlndex</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2017
                    
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>




<script src="/js/app.js?rev=@@hash.js"></script>

</body>
</html>